<html>

<script type="text/javascript" charset="utf-8" src="../cordova.js"></script>
<script type="text/javascript">  

var pictureSource;   // picture source
                        var destinationType; // sets the format of returned value
                        var urlfoto;
                        // Wait for device API libraries to load
                        //
                        document.addEventListener("deviceready",onDeviceReady,false);

                        // device APIs are available
                        //
                        function onDeviceReady() {
                            pictureSource=navigator.camera.PictureSourceType;
                            destinationType=navigator.camera.DestinationType;
                        }

                        // Called when a photo is successfully retrieved
                        //
                        function onPhotoDataSuccess(imageData) {

                          urlfoto=imageData;
                          // Uncomment to view the base64-encoded image data
                          // console.log(imageData);
                            alert(imageData);
                          // Get image handle
                          //
                          var smallImage = document.getElementById('smallImage');

                          // Unhide image elements
                          //
                          smallImage.style.display = 'block';

                          // Show the captured photo
                          // The inline CSS rules are used to resize the image
                          //
                          smallImage.src = "data:image/jpeg;base64," + imageData;
                        }

                        // Called when a photo is successfully retrieved
                        //
                        function onPhotoURISuccess(imageURI) {
                          // Uncomment to view the image file URI
                          // console.log(imageURI);
                        alert(imageURI);
                          // Get image handle
                          //
                          var largeImage = document.getElementById('largeImage');

                          // Unhide image elements
                          //
                          largeImage.style.display = 'block';

                          // Show the captured photo
                          // The inline CSS rules are used to resize the image
                          //
                          largeImage.src = imageURI;
                        }

                        // A button will call this function
                        //
                        function capturePhoto() {
                          // Take picture using device camera and retrieve image as base64-encoded string
                          navigator.camera.getPicture(EnviarServidor, onFail, { quality: 50,
                            destinationType: destinationType.DATA_URI,targetWidth: 500,
                              targetHeight: 500,saveToPhotoAlbum: true });
                        }

                           /*navigator.camera.getPicture(onSuccess, onFail, { quality : 75,
                              destinationType : destinationType.DATA_URL,
                              sourceType : pictureSourceType.CAMERA,
                              allowEdit : true,
                              encodingType: encodingType.JPEG,
                              targetWidth: 500,
                              targetHeight: 500,
                              popoverOptions: CameraPopoverOptions,
                              saveToPhotoAlbum: true });
                        }*/


                        // A button will call this function
                        //
                      

                        // Coger de la Galeria
                        //
                        function getPhoto(source) {


                          // Retrieve image file location from specified source
                          navigator.camera.getPicture(EnviarServidor, onFail, { quality: 50,
                            destinationType : Camera.DestinationType.FILE_URI,
                            sourceType: source });
                        }

                        // Called if something bad happens.
                        //
                        function onFail(message) {
                          //alert('Failed because: ' + message);
                        }

                        function EnviarServidor(image){
                          
                         
                                path = image.fullPath;
                                name = image.name;
                                
                                var options = new FileUploadOptions();
                                options.fileKey="file";
                                options.fileName=image.name;
                                options.mimeType="image/jpeg";
                               
                                var params = new Object();
                                params.fullpath = path;
                                params.name = name;

                                options.params = params;
                                options.chunkedMode = false;
                                var url="http://parkingapp.260mb.net/subir.php";
                                var url2="http://parkingapp.260mb.net/subir.php";
                                var ft = new FileTransfer();
                                ft.upload(image, url2, win, fail, options, true);
                            }
                            function win(r) {
                              alert("Image uploaded successfully!!");
                          }
                          //Failure callback
                          function fail(error) {
                              alert("There was an error uploading image");
                          }
                          // Called if something bad happens.
                          // 
                          function onFail(message) {
                              alert('Failed because: ' + message);
                          }
</script>
</head>
<body>
  <input name="button" type="button" onclick="capturePhoto()" value="Take Photo"/>

<input name="button" type="button" onclick="getPhoto();" value="Browse" />
</body>
</html> 